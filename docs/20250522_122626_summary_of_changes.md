# Metrics Avg Enhancement - 20250522_122626

This document summarizes the recent modifications made to the Phone Extraction Pipeline.

## 1. Identified JSON Placeholder Location

*   **Task:** Locate the usage of the placeholder string `[Insert JSON list of (candidate_number, source_url, snippet) objects here]`.
*   **Action:** Searched the codebase for the specified string.
*   **Result:** The placeholder was found in [`src/llm_extractor_component.py`](src/llm_extractor_component.py) at lines 321 and 422. It is used within prompt templates for LLM interactions, where it's replaced by a JSON string of candidate phone numbers, their source URLs, and context snippets.

## 2. Enhanced Metrics Reporting with Averages

*   **Task:** Include average task durations in the pipeline's metrics report.
*   **Action:**
    *   Identified the `write_run_metrics` function in [`main_pipeline.py`](main_pipeline.py:982) as the responsible component for generating the metrics markdown file.
    *   Modified this function to calculate and include the following averages:
        *   Average Scrape Website Duration (per New Canonical Site Scraped)
        *   Average Regex Extraction Duration (per Site Processed for Regex)
        *   Average LLM Extraction Duration (per Site Processed for LLM)
        *   Average Pass 1 Main Loop Duration (per Input Row)
    *   Added a new subsection titled "Average Task Durations (per relevant item):" to the metrics report to display these new averages.
*   **Result:** The metrics report generated by [`main_pipeline.py`](main_pipeline.py) will now provide more detailed insights into task performance by including these average durations.